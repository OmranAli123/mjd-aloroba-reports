<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ุงูุชูุฑูุฑ ุงููููู ุงูููุญุฏ - ูุฑู ุงููุดุฑูุน</title>
  <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'El Messiri', sans-serif;
      background-color: #f7f7fa;
      color: #333;
      margin: 20px;
      line-height: 1.7;
    }
    .page-container {
      max-width: 1120px;
      margin: auto;
    }
    .top-bar {
      background: #fff;
      padding: 15px 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      justify-content: space-between;
    }
    .top-bar-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #17a2b8;
    }
    .top-bar select {
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      min-width: 220px;
      font-family: inherit;
      font-size: 0.95rem;
    }

    .container {
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 25px;
    }
    h1 {
      text-align: center;
      border-bottom: 3px solid #17a2b8;
      padding-bottom: 10px;
      color: #17a2b8;
    }
    h1.team-b {
      border-color: #17a2b8;
      color: #17a2b8;
    }
    h1.team-c {
      border-color: #dc3545;
      color: #dc3545;
    }
    h2 {
      color: #28a745;
      border-bottom: 2px solid #ccc;
      padding-bottom: 6px;
      margin-top: 20px;
    }
    .team-c h2 {
      color: #17a2b8;
    }
    table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
    th, td { border: 1px solid #dee2e6; padding: 8px; vertical-align: middle; }
    th { background-color: #17a2b8; color: white; text-align: center; }
    .summary-table th { background-color: #6c757d; }
    .resources-table th { background-color: #ffc107; color: #333; }
    .safety-check.team-a th { background-color: #dc3545; color:#fff; }
    .team-b .safety-check th { background-color: #dc3545; color:#fff; }
    .team-c .safety-check th { background-color: #28a745; color:#fff; }
    .team-c .summary-table th { background-color: #17a2b8; }
    input, textarea {
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 6px;
      font-family: inherit;
      font-size: 1rem;
      box-sizing: border-box;
    }
    textarea {
      min-height: 60px;
      resize: vertical;
    }
    .editable-select {
      width: 100%;
      padding: 6px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .btn {
      background-color: #007bff;
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      margin: 6px 4px 6px 0;
    }
    .btn:hover { background-color: #0056b3; }
    .delete-btn {
      background-color: #dc3545; color:#fff; border:none;
      border-radius:5px; padding:4px 10px; cursor:pointer;
    }
    .delete-btn:hover { background-color: #b02a37; }
    .header-table td {
      border: none;
      padding: 6px 12px;
    }
    .footer-section {
      margin-top: 30px;
      border-top: 2px solid #ccc;
      padding-top: 15px;
    }

    .report-panel {
      display: none;
    }
    .report-panel.active {
      display: block;
    }

    /* ุงูุญููู ุงูุฅูุฒุงููุฉ ุนูุฏ ูุฌูุฏ ุฎุทุฃ */
    .required-field.error {
      border-color: #dc3545 !important;
      box-shadow: 0 0 0 1px rgba(220,53,69,0.3);
    }

    @media print {
      .top-bar { display: none; }
      body { margin: 0; background: #fff; }
      .page-container { max-width: none; margin: 0; }

      /* ุฅุฎูุงุก ุฌููุน ุงูุฃุฒุฑุงุฑ ุนูุฏ ุงูุทุจุงุนุฉ */
      .btn,
      .delete-btn {
        display: none !important;
      }
    }
  </style>
</head>
<body>
<div class="page-container">

  <!-- ุดุฑูุท ุงุฎุชูุงุฑ ููุน ุงูุชูุฑูุฑ -->
  <div class="top-bar">
    <div class="top-bar-title">ุงูุชูุฑูุฑ ุงููููู ุงูููุญุฏ ููุดุฑูุน: ุทุฑูู ูุฌุฏ ุงูุนุฑูุจุฉ โ ุงููุฌุงุญ</div>
    <div>
      <label for="reportSelector">ุงุฎุชุฑ ูุฑูู ุงูุชูุฑูุฑ:</label>
      <select id="reportSelector">
        <option value="">-- ุงุฎุชุฑ ููุน ุงูุชูุฑูุฑ --</option>
        <option value="teamA">ุชูุฑูุฑ ุงููุฑูู (ุฃ) - ุฃุนูุงู ุงูุญูุฑ ูุงูุฅุฒุงูุฉ</option>
        <option value="teamB">ุชูุฑูุฑ ุงููุฑูู (ุจ) - ุงูุฃุนูุงู ุงูุชุญุชูุฉ ูุงูุทุจูุงุช ุงููุงุนุฏูุฉ</option>
        <option value="teamC">ุชูุฑูุฑ ุงููุฑูู (ุฌ) - ุงูุฑุตู ูุงูุชุดุทูุจุงุช</option>
      </select>
    </div>
  </div>

  <!-- ุชูุฑูุฑ ุงููุฑูู (ุฃ) -->
  <div id="teamA" class="report-panel">
    <div class="container team-a">
      <h1>ุงูุชูุฑูุฑ ุงููููู ูููุฑูู (ุฃ)</h1>

      <h2>ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h2>
      <table class="header-table">
        <tr>
          <td><strong>ุงุณู ุงููุดุฑูุน:</strong> ุทุฑูู ูุฌุฏ ุงูุนุฑูุจุฉ โ ุงููุฌุงุญ</td>
          <td>
            <strong>ุงูููุทุน ุงูุญุงูู:</strong>
            <input type="text" placeholder="ุงูุชุจ ุฑูู ุฃู ุงุณู ุงูููุทุน" class="required-field section-input">
          </td>
        </tr>
        <tr>
          <td><strong>ุงูุชุงุฑูุฎ (ูููุงุฏู):</strong> <input type="text" class="reportDate" readonly></td>
          <td><strong>ุงูููู:</strong> <input type="text" class="reportDay" readonly></td>
        </tr>
      </table>

      <h2>1. ุงูุฃุนูุงู ุงูููุฌุฒุฉ ุงูููู</h2>
      <table class="summary-table">
        <thead>
          <tr><th>ุงููููุฉ</th><th>ุงููุตู</th><th>ุงููููุฉ ุงูููุฌุฒุฉ</th><th>ุฅุฌุฑุงุก</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <input list="workOptionsA" class="editable-select required-field" placeholder="ุงุฎุชุฑ ุฃู ุงูุชุจ ูููุฉ">
              <datalist id="workOptionsA">
                <option>ุชุญุฏูุฏ ุงููููุน ูุงูุชุฎุทูุท</option>
                <option>ุฅุฒุงูุฉ ุงูุฃุณููุช ุงููุฏูู</option>
                <option>ุงูุญูุฑ ูุงูุชูุณุนุฉ</option>
                <option>ููู ุงููุฎููุงุช</option>
                <option>ุชุณููุฉ ุงูุฃุฑุถูุฉ</option>
                <option>ุฑุฏู ุฃููู / ุชุฏุนูู ุฌุงูุจู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><textarea class="required-field"></textarea></td>
            <td><input class="required-field"></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุจูุฏ</button>

      <h2>2. ุงูููุธููู</h2>
      <table class="resources-table">
        <thead><tr><th>ุงููุธููุฉ</th><th>ุงูุนุฏุฏ</th><th>ููุงุญุธุงุช</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="laborOptionsA" class="editable-select" placeholder="ุงุฎุชุฑ ุฃู ุงูุชุจ ูุธููุฉ">
              <datalist id="laborOptionsA">
                <option>ูุดุฑู ุฃุนูุงู</option>
                <option>ูุฑุงูุจ ุณูุงูุฉ</option>
                <option>ุณุงุฆู ุญูุงุฑ</option>
                <option>ุณุงุฆู ุดุงุญูุฉ</option>
                <option>ุนุงูู</option>
                <option>ูููุฏุณ ูููุน</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><input type="number" min="0"></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุนุงูู</button>

      <h2>3. ุงููุนุฏุงุช</h2>
      <table class="resources-table">
        <thead><tr><th>ุงูุขููุฉ</th><th>ุงูุนุฏุฏ</th><th>ุณุงุนุงุช ุงูุชุดุบูู</th><th>ุงูุญุงูุฉ</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="equipOptionsA" class="editable-select" placeholder="ุงุฎุชุฑ ุฃู ุงูุชุจ ููุน ุงููุนุฏุฉ">
              <datalist id="equipOptionsA">
                <option>ุญูุงุฑ (Excavator)</option>
                <option>ุฌุฑุงูุฉ / ุดููู (Loader)</option>
                <option>ูุงุดุทุฉ ุฃุณููุช</option>
                <option>ุดุงุญูุฉ ููู</option>
                <option>ูุฏุญูุฉ</option>
                <option>ุตูุฑูุฌ ููุงู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><input type="number" min="0"></td>
            <td><input></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ูุนุฏุฉ</button>

      <h2>4. ูุญุต ุงูุฌูุฏุฉ ูุงูุณูุงูุฉ</h2>
      <table class="safety-check team-a">
        <thead><tr><th>ุงูุจูุฏ</th><th>โ</th><th>ุงูููุงุญุธุงุช</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="safetyOptionsA" class="editable-select" placeholder="ุงุฎุชุฑ ุฃู ุงูุชุจ ุจูุฏ ุงููุญุต">
              <datalist id="safetyOptionsA">
                <option>ุชุฃููู ููุทูุฉ ุงูุนูู</option>
                <option>ูุนุฏุงุช ุงูููุงูุฉ ุงูุดุฎุตูุฉ</option>
                <option>ุงูุฅุดุงุฑุงุช ุงูุชุญุฐูุฑูุฉ</option>
                <option>ูุธุงูุฉ ุงููููุน</option>
                <option>ุงุฎุชุจุงุฑุงุช ุงูุฌูุฏุฉ</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td style="text-align:center;"><input type="checkbox"></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุจูุฏ ูุญุต</button>

      <h2>5. ุงููุนููุงุช ูุงูููุงุญุธุงุช</h2>
      <table>
        <thead><tr><th>ุงููุตู</th><th>ุงูุฅุฌุฑุงุก ุงููุชุฎุฐ / ุงููุทููุจ</th><th>ุงูุญุงูุฉ</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="issueOptionsA" class="editable-select" placeholder="ุงุฎุชุฑ ุฃู ุงูุชุจ ููุน ุงููุนูู">
              <datalist id="issueOptionsA">
                <option>ุนุทู ูู ุงููุนุฏุงุช</option>
                <option>ุชุฃุฎูุฑ ุชูุฑูุฏ ุงูููุงุฏ</option>
                <option>ุฃุญูุงู ุฌููุฉ</option>
                <option>ุชุนุงุฑุถ ูุน ูุฑู ุฃุฎุฑู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><textarea></textarea></td>
            <td><input placeholder="ููุชูุญ / ูุบูู"></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ููุงุญุธุฉ</button>

      <div class="footer-section">
        <h2>ุจูุงูุงุช ูุนุฏู ุงูุชูุฑูุฑ</h2>
        <table class="header-table">
          <tr>
            <td>
              <strong>ุงุณู ูุนุฏู ุงูุชูุฑูุฑ:</strong>
              <input type="text" placeholder="ุงูุชุจ ุงุณู ูุนุฏู ุงูุชูุฑูุฑ" class="required-field prepared-by-input">
            </td>
          </tr>
        </table>
      </div>

      <button class="btn" onclick="saveReportToSupabase(this)">๐พ ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช</button>
      <button class="btn" onclick="validateAndPrint(this)">๐จ ุทุจุงุนุฉ ุงูุชูุฑูุฑ</button>
    </div>
  </div>

  <!-- ุชูุฑูุฑ ุงููุฑูู (ุจ) -->
  <div id="teamB" class="report-panel">
    <div class="container team-b">
      <h1 class="team-b">ุงูุชูุฑูุฑ ุงููููู ูููุฑูู (ุจ)</h1>

      <h2>ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h2>
      <table class="header-table">
        <tr>
          <td><strong>ุงุณู ุงููุดุฑูุน:</strong> ุทุฑูู ูุฌุฏ ุงูุนุฑูุจุฉ โ ุงููุฌุงุญ</td>
          <td>
            <strong>ุงูููุทุน ุงูุญุงูู:</strong>
            <input type="text" placeholder="ุงูุชุจ ุฑูู ุฃู ุงุณู ุงูููุทุน" class="required-field section-input">
          </td>
        </tr>
        <tr>
          <td><strong>ุงูุชุงุฑูุฎ (ูููุงุฏู):</strong> <input type="text" class="reportDate" readonly></td>
          <td><strong>ุงูููู:</strong> <input type="text" class="reportDay" readonly></td>
        </tr>
      </table>

      <h2>1. ุงูุฃุนูุงู ุงูููุฌุฒุฉ ุงูููู</h2>
      <table class="summary-table">
        <thead>
          <tr><th>ุงููููุฉ</th><th>ุงููุตู</th><th>ุงููููุฉ ุงูููุฌุฒุฉ</th><th>ุฅุฌุฑุงุก</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <input list="workOptionsB" class="editable-select required-field">
              <datalist id="workOptionsB">
                <option>ุชูุฏูุฏ ุงูููุงุณูุฑ ุงูุฃุฑุถูุฉ</option>
                <option>ุชูุฏูุฏ ุงููุงุจูุงุช ุงูููุฑุจุงุฆูุฉ</option>
                <option>ุตุจ ููุงุนุฏ ุงูุฅูุงุฑุฉ</option>
                <option>ูุฑุด ุทุจูุฉ Sub-base</option>
                <option>ุงุฎุชุจุงุฑุงุช ุงูุฏู (Sub-base)</option>
                <option>ูุฑุด ุทุจูุฉ Base course</option>
                <option>ุงุฎุชุจุงุฑุงุช ุงูุฏู (Base course)</option>
                <option>ุชูุธูู ุงููููุน ูุชุญุถูุฑู ููุชุณููู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><textarea class="required-field"></textarea></td>
            <td><input class="required-field"></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุจูุฏ</button>

      <h2>2. ุงูููุธููู</h2>
      <table class="resources-table">
        <thead><tr><th>ุงููุธููุฉ</th><th>ุงูุนุฏุฏ</th><th>ููุงุญุธุงุช</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="laborOptionsB" class="editable-select">
              <datalist id="laborOptionsB">
                <option>ูุดุฑู ูุฏูู</option>
                <option>ููู ูุฎุชุจุฑ</option>
                <option>ูุณุงุญ</option>
                <option>ูุดุบู ูุฏุญูุฉ</option>
                <option>ูุดุบู ููฺพุฏุฉ</option>
                <option>ุนุงูู ุชูุฏูุฏุงุช</option>
                <option>ุนุงูู ูุณุงุนุฏ</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><input type="number" min="0"></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุนุงูู</button>

      <h2>3. ุงููุนุฏุงุช</h2>
      <table class="resources-table">
        <thead><tr><th>ุงูุขููุฉ</th><th>ุงูุนุฏุฏ</th><th>ุณุงุนุงุช ุงูุชุดุบูู</th><th>ุงูุญุงูุฉ</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="equipOptionsB" class="editable-select">
              <datalist id="equipOptionsB">
                <option>ูุฏุญูุฉ ุงูุชุฒุงุฒูุฉ</option>
                <option>ูุฏุญูุฉ ููุฑุงุช</option>
                <option>ููฺพุฏุฉ</option>
                <option>ุตูุฑูุฌ ููุงู</option>
                <option>ุดููู</option>
                <option>ุญูุงุฑ</option>
                <option>ุดุงุญูุงุช ููู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><input type="number" min="0"></td>
            <td><input></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ูุนุฏุฉ</button>

      <h2>4. ูุญุต ุงูุฌูุฏุฉ ูุงูุณูุงูุฉ</h2>
      <table class="safety-check">
        <thead><tr><th>ุงูุจูุฏ</th><th>โ</th><th>ุงูููุงุญุธุงุช</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="safetyOptionsB" class="editable-select">
              <datalist id="safetyOptionsB">
                <option>ุงุฎุชุจุงุฑุงุช ุงููุซุงูุฉ ูุงูุฑุทูุจุฉ</option>
                <option>ุชุญูู ุงูุฏู ูุทุจูุฉ Sub-base</option>
                <option>ุชุญูู ุงูุฏู ูุทุจูุฉ Base course</option>
                <option>ุชุฃููู ุงูุฎูุงุฏู ูุงูุชูุฏูุฏุงุช</option>
                <option>ูุธุงูุฉ ุงููููุน</option>
                <option>ุณูุงูุฉ ุงููุนุฏุงุช ูุงูุนูุงู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td style="text-align:center;"><input type="checkbox"></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุจูุฏ ูุญุต</button>

      <h2>5. ุงููุนููุงุช ูุงูููุงุญุธุงุช</h2>
      <table>
        <thead><tr><th>ุงููุตู</th><th>ุงูุฅุฌุฑุงุก ุงููุชุฎุฐ / ุงููุทููุจ</th><th>ุงูุญุงูุฉ</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="issueOptionsB" class="editable-select">
              <datalist id="issueOptionsB">
                <option>ุชุฃุฎุฑ ุงูููุงุฏ</option>
                <option>ุนุทู ูุนุฏุฉ</option>
                <option>ุธุฑูู ุฌููุฉ</option>
                <option>ุชุนุงุฑุถ ุฃุนูุงู</option>
                <option>ููุต ุนูุงูุฉ</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><textarea></textarea></td>
            <td><input placeholder="ููุชูุญ / ูุบูู"></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ููุงุญุธุฉ</button>

      <div class="footer-section">
        <h2>ุจูุงูุงุช ูุนุฏู ุงูุชูุฑูุฑ</h2>
        <table class="header-table">
          <tr>
            <td>
              <strong>ุงุณู ูุนุฏู ุงูุชูุฑูุฑ:</strong>
              <input type="text" placeholder="ุงูุชุจ ุงุณู ูุนุฏู ุงูุชูุฑูุฑ" class="required-field prepared-by-input">
            </td>
          </tr>
        </table>
      </div>

      <button class="btn" onclick="saveReportToSupabase(this)">๐พ ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช</button>
      <button class="btn" onclick="validateAndPrint(this)">๐จ ุทุจุงุนุฉ ุงูุชูุฑูุฑ</button>
    </div>
  </div>

  <!-- ุชูุฑูุฑ ุงููุฑูู (ุฌ) -->
  <div id="teamC" class="report-panel">
    <div class="container team-c">
      <h1 class="team-c">ุงูุชูุฑูุฑ ุงููููู ูููุฑูู (ุฌ)</h1>
      <h2>ุงูุฑุตู ูุงูุชุดุทูุจุงุช</h2>

      <h2>ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h2>
      <table class="header-table">
        <tr>
          <td><strong>ุงุณู ุงููุดุฑูุน:</strong> ุงูุทุฑูู ุงูุฑุงุจุท ุจูู ูุฌุฏ ุงูุนุฑูุจุฉ ูุงููุฌุงุญ</td>
          <td>
            <strong>ุงูููุทุน ุงูุญุงูู:</strong>
            <input type="text" placeholder="ุงูุชุจ ุฑูู ุฃู ุงุณู ุงูููุทุน" class="required-field section-input">
          </td>
        </tr>
        <tr>
          <td><strong>ุงูุชุงุฑูุฎ (ูููุงุฏู):</strong> <input type="text" class="reportDate" readonly></td>
          <td><strong>ุงูููู:</strong> <input type="text" class="reportDay" readonly></td>
        </tr>
      </table>

      <h2>1. ุงูุฃุนูุงู ุงูููุฌุฒุฉ ุงูููู</h2>
      <table class="summary-table">
        <thead>
          <tr><th>ุงููููุฉ</th><th>ุงููุตู</th><th>ุงููููุฉ ุงูููุฌุฒุฉ</th><th>ุฅุฌุฑุงุก</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <input list="workOptionsC" class="editable-select required-field">
              <datalist id="workOptionsC">
                <option>ุฑุด ุทุจูุฉ ุชุดุฑูุจ (Prime Coat)</option>
                <option>ูุฑุด ุทุจูุฉ ุชุดุฑูุจ ูุงุตูุฉ (Tack Coat)</option>
                <option>ูุฑุด ุทุจูุฉ ุงูุฃุณููุช ุงูุฑุงุจุทุฉ</option>
                <option>ูุฑุด ุทุจูุฉ ุงูุฃุณููุช ุงูููุงุฆูุฉ</option>
                <option>ุฏูู ูุชุดุทูุจ ุงูุฃุณููุช</option>
                <option>ุชุฎุทูุท ุงูุดูุงุฑุน (ุฏูุงูุงุช ูุฑูุฑูุฉ)</option>
                <option>ุชุฑููุจ ุฅุดุงุฑุงุช ูุฑูุฑูุฉ</option>
                <option>ุชุฑููุจ ุฃุนูุฏุฉ ููุดุงูุงุช ุงูุฅูุงุฑุฉ</option>
                <option>ุชูุธูู ุงููููุน ููุชุณููู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><textarea class="required-field"></textarea></td>
            <td><input class="required-field"></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุจูุฏ</button>

      <h2>2. ุงูููุธููู</h2>
      <table class="resources-table">
        <thead><tr><th>ุงููุธููุฉ</th><th>ุงูุนุฏุฏ</th><th>ุงูููุงู</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="laborOptionsC" class="editable-select">
              <datalist id="laborOptionsC">
                <option>ูุดุฑู ุฃุนูุงู ุฅุณููุช</option>
                <option>ูููุฏุณ ููุฑุจุงุก</option>
                <option>ููู ูุฎุชุจุฑ (ุฃุณููุช)</option>
                <option>ูุดุบู ูููุงุดุฉ ุฃุณููุช</option>
                <option>ูุดุบู ูุฏุญูุฉ</option>
                <option>ุนุงูู ุฏูุงูุงุช ุฎุทูุท ุงูุทุฑู</option>
                <option>ููู ููุฑุจุงุก ูุฅูุงุฑุฉ</option>
                <option>ุนูุงู ุนุงููู</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><input type="number" min="0"></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุนุงูู</button>

      <h2>3. ุงููุนุฏุงุช</h2>
      <table class="resources-table">
        <thead><tr><th>ุงููุนุฏุฉ</th><th>ุงูุนุฏุฏ</th><th>ุณุงุนุงุช ุงูุชุดุบูู</th><th>ุงูุญุงูุฉ</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="equipOptionsC" class="editable-select">
              <datalist id="equipOptionsC">
                <option>ูููุงุดุฉ ุฃุณููุช (Paver)</option>
                <option>ูุฏุญูุฉ ุงูุชุฒุงุฒูุฉ</option>
                <option>ูุฏุญูุฉ ูุงุนูุฉ (Steel Roller)</option>
                <option>ุตูุฑูุฌ ุฃุณููุช ุณุงุฆู (Sprayer)</option>
                <option>ุขูุฉ ุชุฎุทูุท ุทุฑู</option>
                <option>ุฑุงูุนุฉ ุชุฑููุจ ุฃุนูุฏุฉ</option>
                <option>ุดุงุญูุงุช ููู ุฃุณููุช</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><input type="number" min="0"></td>
            <td><input></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ูุนุฏุฉ</button>

      <h2>4. ูุญุต ุงูุฌูุฏุฉ ูุงูุณูุงูุฉ</h2>
      <table class="safety-check">
        <thead><tr><th>ุงูุจูุฏ</th><th>โ</th><th>ุงูููุงุญุธุงุช</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="safetyOptionsC" class="editable-select">
              <datalist id="safetyOptionsC">
                <option>ุชุญูู ูู ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูุฃุณููุช</option>
                <option>ูุชุงุฆุฌ ุงุฎุชุจุงุฑ ูุงุฑุดุงู (Marshall)</option>
                <option>ูุฑุงูุจุฉ ุฌูุฏุฉ ุงูุฏูู</option>
                <option>ุงุฎุชุจุงุฑ ุณูู ุงูุทุจูุฉ</option>
                <option>ุชุซุจูุช ุฅุดุงุฑุงุช ุงูุชุญุฐูุฑ ุฃุซูุงุก ุงูุนูู</option>
                <option>ุณูุงูุฉ ุงูุนูุงู ูุงููุนุฏุงุช</option>
                <option>ูุธุงูุฉ ุงููููุน ุงูููุงุฆูุฉ</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td style="text-align:center;"><input type="checkbox"></td>
            <td><input></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ุจูุฏ ูุญุต</button>

      <h2>5. ุงููุนููุงุช ูุงูููุงุญุธุงุช</h2>
      <table>
        <thead><tr><th>ุงููุตู</th><th>ุงูุฅุฌุฑุงุก ุงููุชุฎุฐ / ุงููุทููุจ</th><th>ุงูุญุงูุฉ</th><th>ุฅุฌุฑุงุก</th></tr></thead>
        <tbody>
          <tr>
            <td>
              <input list="issueOptionsC" class="editable-select">
              <datalist id="issueOptionsC">
                <option>ุชุฃุฎุฑ ุชูุฑูุฏ ุงูุฃุณููุช</option>
                <option>ุนุทู ูู ุงููููุงุดุฉ ุฃู ุงููุฏุญูุฉ</option>
                <option>ุธุฑูู ุฌููุฉ / ุงุฑุชูุงุน ุญุฑุงุฑุฉ</option>
                <option>ุชุนุงุฑุถ ูุน ูุฑู ุงูููุฑุจุงุก</option>
                <option>ููุต ูู ุงูุนูุงูุฉ ุฃู ุงูููุงุฏ</option>
                <option>ุฃุฎุฑู</option>
              </datalist>
            </td>
            <td><textarea></textarea></td>
            <td><input placeholder="ููุชูุญ / ูุบูู"></td>
            <td><button class="delete-btn" onclick="deleteRow(this)">๐</button></td>
          </tr>
        </tbody>
      </table>
      <button class="btn" onclick="addRow(this)">โ ุฅุถุงูุฉ ููุงุญุธุฉ</button>

      <div class="footer-section">
        <h2>ุจูุงูุงุช ูุนุฏู ุงูุชูุฑูุฑ</h2>
        <table class="header-table">
          <tr>
            <td>
              <strong>ุงุณู ูุนุฏู ุงูุชูุฑูุฑ:</strong>
              <input type="text" placeholder="ุงูุชุจ ุงุณู ูุนุฏู ุงูุชูุฑูุฑ" class="required-field prepared-by-input">
            </td>
          </tr>
        </table>
      </div>

      <button class="btn" onclick="saveReportToSupabase(this)">๐พ ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช</button>
      <button class="btn" onclick="validateAndPrint(this)">๐จ ุทุจุงุนุฉ ุงูุชูุฑูุฑ</button>
    </div>
  </div>

</div>

<!-- ููุชุจุฉ Supabase -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
  // ุถุน ููู ูุดุฑูุนู ููุง
  const SUPABASE_URL = "https://scnatcektqebuwyzflgb.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNjbmF0Y2VrdHFlYnV3eXpmbGdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3ODIzMDksImV4cCI6MjA3ODM1ODMwOX0.meASFDbwYz9Hy7DOKb7ILeGEwWA8faKH5ukJ-XpfLT8";

  const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // ุฎุฑูุทุฉ ุฃุณูุงุก ุงูุดููุฑ ุจุงูุนุฑุจูุฉ ุฅูู ุฃุฑูุงู
  const arabicMonthsMap = {
    "ููุงูุฑ": 1,
    "ูุจุฑุงูุฑ": 2,
    "ูุงุฑุณ": 3,
    "ุฃุจุฑูู": 4,
    "ูุงูู": 5,
    "ููููู": 6,
    "ููููู": 7,
    "ุฃุบุณุทุณ": 8,
    "ุณุจุชูุจุฑ": 9,
    "ุฃูุชูุจุฑ": 10,
    "ููููุจุฑ": 11,
    "ุฏูุณูุจุฑ": 12
  };

  function parseArabicDateToISO(dateStr) {
    if (!dateStr) return null;
    const parts = dateStr.trim().split(/\s+/); // ูุซุงู: "10 ููููุจุฑ 2025"
    if (parts.length < 3) return null;
    const day = parseInt(parts[0], 10);
    const monthName = parts[1];
    const year = parts[2];
    const month = arabicMonthsMap[monthName];
    if (!month || isNaN(day)) return null;
    const dd = String(day).padStart(2, '0');
    const mm = String(month).padStart(2, '0');
    return `${year}-${mm}-${dd}`; // yyyy-mm-dd
  }

  // ุฅุธูุงุฑ / ุฅุฎูุงุก ุงูููุงุฐุฌ ุญุณุจ ุงุฎุชูุงุฑ ุงููุงุฆูุฉ
  function showReport(id) {
    document.querySelectorAll('.report-panel').forEach(p => p.classList.remove('active'));
    if (id) {
      const panel = document.getElementById(id);
      if (panel) panel.classList.add('active');
    }
  }

  document.getElementById('reportSelector').addEventListener('change', function() {
    showReport(this.value);
  });

  // ุฅุถุงูุฉ ุตู ุฌุฏูุฏ ูู ุงูุฌุฏูู ุงูุฃูุฑุจ ููุฒุฑ
  function addRow(btn) {
    let table = btn.previousElementSibling;
    while (table && table.tagName !== 'TABLE') {
      table = table.previousElementSibling;
    }
    if (!table) return;
    const tbody = table.querySelector('tbody');
    if (!tbody || !tbody.rows.length) return;

    const clone = tbody.rows[0].cloneNode(true);
    clone.querySelectorAll('input, textarea').forEach(el => {
      if (el.type === 'checkbox') {
        el.checked = false;
      } else {
        el.value = '';
      }
      el.classList.remove('error');
    });
    tbody.appendChild(clone);
  }

  function deleteRow(btn) {
    const row = btn.closest('tr');
    const tbody = row.parentElement;
    if (tbody.rows.length > 1) {
      row.remove();
    } else {
      alert("โ๏ธ ูุง ูููู ุญุฐู ุขุฎุฑ ุตู!");
    }
  }

  function clearIfOther(e) {
    if (e.target.value && e.target.value.trim() === "ุฃุฎุฑู") {
      e.target.value = "";
    }
  }

  // ุชุทุจูู clearIfOther ุนูู ุฌููุน ุงูุญููู ุฐุงุช ุงููุงุฆูุฉ ุงููุงุจูุฉ ููุชุญุฑูุฑ
  document.addEventListener('input', function(e) {
    if (e.target.classList.contains('editable-select')) {
      clearIfOther(e);
    }
    // ุฅุฒุงูุฉ ุงูุชูููู ุงูุฃุญูุฑ ุนูุฏ ุงูุชุนุฏูู
    if (e.target.classList.contains('required-field')) {
      e.target.classList.remove('error');
    }
  });

  // ุฏุงูุฉ ุงูุชุญูู ูุจู ุงูุทุจุงุนุฉ (ูุง ุฒุงูุช ูุนุงูุฉ ููุท ููุทุจุงุนุฉ)
  function validateAndPrint(btn) {
    const activePanel = btn.closest('.report-panel');
    if (!activePanel || !activePanel.classList.contains('active')) {
      alert("ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุชูุฑูุฑ ูู ุงููุงุฆูุฉ ุงูุนูููุฉ ุฃููุงู.");
      return;
    }

    const requiredFields = activePanel.querySelectorAll('.required-field');
    let firstError = null;
    let hasError = false;

    requiredFields.forEach(field => {
      field.classList.remove('error');
      let invalid = false;

      if (field.type === 'checkbox') {
        if (!field.checked) invalid = true;
      } else {
        if (!field.value || !field.value.trim()) invalid = true;
      }

      if (invalid) {
        field.classList.add('error');
        if (!firstError) firstError = field;
        hasError = true;
      }
    });

    if (hasError) {
      alert("ูุฑุฌู ุชุนุจุฆุฉ ุงูุญููู ุงูุฅูุฒุงููุฉ ุงููุธููุฉ ุจุงูููู ุงูุฃุญูุฑ ูุจู ุงูุทุจุงุนุฉ.");
      if (firstError) {
        firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
        setTimeout(() => {
          try { firstError.focus(); } catch(e) {}
        }, 400);
      }
      return;
    }

    window.print();
  }

  // ุญูุธ ุงูุชูุฑูุฑ ูู Supabase (ุจุฏูู ุชุญูู ูู ุงูุญููู)
  async function saveReportToSupabase(btn) {
    const activePanel = btn.closest('.report-panel');
    if (!activePanel || !activePanel.classList.contains('active')) {
      alert("ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุชูุฑูุฑ ูู ุงููุงุฆูุฉ ุงูุนูููุฉ ุฃููุงู.");
      return;
    }

    // ุชุญุฏูุฏ ุงููุฑูู ูู id
    let teamCode = "";
    if (activePanel.id === "teamA") teamCode = "A";
    else if (activePanel.id === "teamB") teamCode = "B";
    else if (activePanel.id === "teamC") teamCode = "C";
    else teamCode = "UNKNOWN";

    const container = activePanel.querySelector('.container');

    // ุงุณู ุงููุดุฑูุน ูู ุฃูู ุฎููุฉ
    let projectName = "";
    const firstHeaderCell = container.querySelector('.header-table tr:first-child td:first-child');
    if (firstHeaderCell) {
      const text = firstHeaderCell.textContent || "";
      projectName = text.replace("ุงุณู ุงููุดุฑูุน:", "").trim();
    }

    // ุญูู ุงูููุทุน ุงูุญุงูู
    const sectionInput = container.querySelector('.section-input');
    const sectionName = sectionInput ? sectionInput.value.trim() : "";

    // ุงูุชุงุฑูุฎ ูุงูููู
    const reportDateInput = container.querySelector('.reportDate');
    const reportDayInput = container.querySelector('.reportDay');
    const reportDateStr = reportDateInput ? reportDateInput.value.trim() : "";
    const reportDay = reportDayInput ? reportDayInput.value.trim() : "";

    // ุงุณู ูุนุฏู ุงูุชูุฑูุฑ
    const preparedByInput = container.querySelector('.prepared-by-input');
    const preparedBy = preparedByInput ? preparedByInput.value.trim() : "";

    // ุชุญููู ุงูุชุงุฑูุฎ ุฃู ุงุณุชุฎุฏุงู ุงูููู ุงูุญุงูู
    let isoDate = null;
    if (reportDateStr) {
      isoDate = parseArabicDateToISO(reportDateStr);
    }
    if (!isoDate) {
      const now = new Date();
      isoDate = now.toISOString().split('T')[0];
    }

    // ุฅุฏุฎุงู ุฑุฃุณ ุงูุชูุฑูุฑ
    const { data: reportData, error: reportError } = await supabaseClient
      .from('daily_reports')
      .insert([
        {
          team_code: teamCode,
          project_name: projectName || "ุทุฑูู ูุฌุฏ ุงูุนุฑูุจุฉ โ ุงููุฌุงุญ",
          section_name: sectionName || null,
          report_date: isoDate,
          report_day: reportDay || null,
          prepared_by: preparedBy || null
        }
      ])
      .select()
      .single();

    if (reportError) {
      console.error(reportError);
      alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุฑุฃุณ ุงูุชูุฑูุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.");
      return;
    }

    const reportId = reportData.id;

    // ุฅูุฌุงุฏ ุฌุฏูู "ุงูุฃุนูุงู ุงูููุฌุฒุฉ ุงูููู"
    let workTable = null;
    const h2List = container.querySelectorAll('h2');
    h2List.forEach(h => {
      if (!workTable && h.textContent.includes("ุงูุฃุนูุงู ุงูููุฌุฒุฉ ุงูููู")) {
        let el = h.nextElementSibling;
        while (el && el.tagName !== 'TABLE') {
          el = el.nextElementSibling;
        }
        if (el && el.classList.contains('summary-table')) {
          workTable = el;
        }
      }
    });

    const itemsToInsert = [];

    if (workTable) {
      const rows = workTable.querySelectorAll('tbody tr');
      rows.forEach(row => {
        const taskInput = row.querySelector('td:nth-child(1) input, td:nth-child(1) select');
        const descInput = row.querySelector('td:nth-child(2) textarea, td:nth-child(2) input');
        const qtyInput  = row.querySelector('td:nth-child(3) input');

        const taskName = taskInput ? taskInput.value.trim() : "";
        const description = descInput ? descInput.value.trim() : "";
        const quantity = qtyInput ? qtyInput.value.trim() : "";

        if (taskName || description || quantity) {
          itemsToInsert.push({
            report_id: reportId,
            item_type: "work",
            task_name: taskName || null,
            description: description || null,
            quantity: quantity || null,
            extra: {}
          });
        }
      });
    }

    if (itemsToInsert.length > 0) {
      const { error: itemsError } = await supabaseClient
        .from('daily_report_items')
        .insert(itemsToInsert);

      if (itemsError) {
        console.error(itemsError);
        alert("ุชู ุญูุธ ุฑุฃุณ ุงูุชูุฑูุฑุ ููู ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุจููุฏ ุงูุฃุนูุงู.");
        return;
      }
    }

    alert("โ ุชู ุญูุธ ุงูุชูุฑูุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ.");
  }

  // ุชุนุจุฆุฉ ุงูุชุงุฑูุฎ ูุงูููู ูุฌููุน ุงูููุงุฐุฌ
  document.addEventListener('DOMContentLoaded', function() {
    const months = ["ููุงูุฑ","ูุจุฑุงูุฑ","ูุงุฑุณ","ุฃุจุฑูู","ูุงูู","ููููู","ููููู","ุฃุบุณุทุณ","ุณุจุชูุจุฑ","ุฃูุชูุจุฑ","ููููุจุฑ","ุฏูุณูุจุฑ"];
    const days = ["ุงูุฃุญุฏ","ุงูุงุซููู","ุงูุซูุงุซุงุก","ุงูุฃุฑุจุนุงุก","ุงูุฎููุณ","ุงูุฌูุนุฉ","ุงูุณุจุช"];
    const now = new Date();
    const dateStr = `${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()}`;
    const dayStr = days[now.getDay()];

    document.querySelectorAll('.reportDate').forEach(el => el.value = dateStr);
    document.querySelectorAll('.reportDay').forEach(el => el.value = dayStr);

    // ุงูุชุฑุงุถููุง ุนุฑุถ ุชูุฑูุฑ ุงููุฑูู (ุฃ)
    document.getElementById('reportSelector').value = 'teamA';
    showReport('teamA');
  });
</script>
</body>
</html>
